var sample_data = {"id":1,"width":40,"height":20,"hexes":{"[20, 17]":1,"[3, 17]":2,"[29, 2]":3,"[13, 1]":4,"[11, 16]":5,"[45, 4]":6,"[32, 2]":7,"[24, 2]":8,"[7, 9]":9,"[7, 6]":10,"[30, 17]":11,"[34, 9]":12,"[37, 17]":13,"[42, 9]":14,"[40, 18]":15,"[39, 9]":16,"[41, 1]":17,"[35, 15]":18,"[40, 1]":19,"[6, 11]":20,"[23, 16]":21,"[36, 3]":22,"[19, 9]":23,"[35, 1]":24,"[3, 18]":25,"[19, 19]":26,"[26, 7]":27,"[25, 6]":28,"[22, 6]":29,"[5, 9]":30,"[31, 3]":7,"[18, 19]":26,"[40, 17]":15,"[3, 16]":2,"[35, 8]":12,"[35, 4]":22,"[35, 2]":24,"[6, 9]":30,"[4, 18]":25,"[18, 18]":26,"[39, 18]":15,"[39, 19]":15,"[25, 1]":8,"[27, 7]":27,"[26, 8]":27,"[5, 17]":25,"[19, 10]":23,"[36, 0]":24,"[6, 8]":30,"[35, 3]":22,"[40, 8]":16,"[6, 16]":25,"[30, 2]":3,"[20, 9]":23,"[7, 15]":25,"[8, 6]":10,"[4, 19]":25,"[36, 4]":22,"[4, 17]":25,"[22, 17]":21,"[22, 18]":21,"[46, 4]":6,"[6, 12]":20,"[23, 3]":8,"[34, 15]":18,"[40, 2]":19,"[25, 2]":8,"[31, 16]":11,"[35, 0]":24,"[37, 2]":22,"[21, 8]":23,"[10, 17]":5,"[5, 10]":30,"[40, 0]":19,"[31, 2]":7,"[32, 3]":7,"[36, 18]":13,"[21, 9]":23,"[20, 10]":23,"[30, 4]":7,"[23, 17]":21,"[19, 8]":23,"[38, 2]":22,"[5, 18]":25,"[39, 1]":19,"[5, 16]":25,"[21, 7]":29,"[24, 16]":21,"[46, 3]":6,"[8, 5]":10,"[25, 5]":28,"[19, 11]":23,"[22, 16]":21,"[29, 3]":3,"[31, 4]":7,"[26, 2]":8,"[22, 8]":23,"[34, 8]":12,"[27, 6]":27,"[11, 17]":5,"[8, 7]":10,"[22, 19]":21,"[40, 7]":16,"[45, 5]":6,"[29, 18]":11,"[22, 15]":21,"[25, 15]":21,"[22, 7]":23,"[22, 9]":23,"[23, 5]":29,"[3, 19]":25,"[9, 4]":10,"[19, 18]":26,"[24, 15]":21,"[35, 9]":12,"[6, 17]":25,"[38, 1]":22,"[39, 8]":16,"[24, 17]":21,"[2, 19]":25,"[20, 11]":23,"[39, 7]":16,"[23, 18]":21,"[2, 18]":25,"[8, 14]":25,"[26, 9]":27,"[37, 18]":13,"[18, 11]":23,"[35, 19]":13,"[26, 5]":28,"[27, 5]":28,"[25, 8]":27,"[23, 15]":21,"[34, 4]":22,"[41, 2]":19,"[41, 0]":17,"[4, 16]":25,"[24, 14]":21,"[28, 2]":3,"[23, 9]":23,"[44, 4]":6,"[25, 16]":21,"[23, 6]":29,"[33, 10]":12,"[36, 1]":24,"[17, 19]":26,"[40, 16]":15,"[24, 4]":29,"[28, 3]":3,"[28, 4]":3,"[32, 15]":11,"[46, 2]":6,"[2, 17]":2,"[23, 2]":8,"[9, 5]":10,"[45, 3]":6,"[10, 16]":5,"[27, 3]":3,"[2, 16]":2,"[16, 19]":26,"[31, 5]":7,"[27, 2]":3,"[34, 3]":22,"[30, 3]":7,"[29, 1]":3,"[34, 19]":13,"[40, 6]":16,"[30, 18]":11,"[32, 11]":12,"[23, 7]":23,"[24, 18]":21,"[44, 3]":6,"[26, 15]":21,"[28, 5]":3,"[21, 10]":23,"[6, 18]":25,"[30, 1]":3,"[39, 0]":19,"[12, 15]":5,"[38, 19]":15,"[21, 19]":21,"[39, 2]":22,"[25, 18]":21,"[21, 16]":21,"[30, 0]":3,"[38, 17]":13,"[32, 4]":7,"[35, 14]":18,"[28, 1]":3,"[39, 17]":15,"[7, 16]":25,"[47, 3]":6,"[21, 17]":1,"[17, 18]":26,"[25, 19]":21,"[41, 16]":15,"[18, 9]":23,"[7, 17]":25,"[24, 9]":23,"[34, 10]":12,"[12, 14]":5,"[31, 17]":11,"[36, 2]":22,"[29, 5]":3,"[13, 15]":5,"[17, 11]":23,"[27, 1]":3,"[1, 18]":25,"[7, 18]":25,"[20, 18]":1,"[32, 10]":12,"[41, 6]":16,"[9, 17]":5,"[48, 2]":6,"[1, 17]":2,"[31, 11]":12,"[26, 16]":21,"[41, 7]":16,"[27, 4]":3,"[25, 7]":27,"[26, 14]":21,"[20, 8]":23,"[42, 0]":17,"[29, 0]":3,"[10, 18]":5,"[9, 6]":10,"[31, 10]":12,"[1, 19]":25,"[18, 10]":23,"[47, 2]":6,"[11, 15]":5,"[42, 6]":16,"[28, 0]":3,"[45, 2]":6,"[20, 7]":23,"[32, 9]":12,"[37, 3]":22,"[25, 13]":21,"[24, 8]":27,"[5, 15]":25,"[34, 5]":22,"[21, 11]":23,"[36, 15]":18,"[34, 0]":24,"[32, 16]":11,"[31, 0]":3,"[33, 9]":12,"[27, 13]":21,"[21, 15]":21,"[23, 19]":21,"[30, 5]":7,"[41, 9]":14,"[43, 5]":16,"[31, 12]":12,"[36, 7]":12,"[46, 1]":6,"[36, 13]":18,"[23, 8]":23,"[19, 17]":1,"[40, 9]":14,"[44, 5]":6,"[35, 18]":13,"[28, 6]":27,"[42, 1]":17,"[31, 18]":11,"[12, 16]":5,"[44, 2]":6,"[33, 4]":7,"[47, 1]":6,"[31, 15]":11,"[17, 12]":23,"[37, 1]":22,"[27, 15]":21,"[21, 6]":23,"[43, 2]":6,"[22, 10]":23,"[48, 1]":6,"[29, 4]":3,"[43, 4]":6,"[24, 6]":29,"[12, 17]":5,"[38, 9]":16,"[13, 16]":5,"[39, 10]":14,"[37, 0]":24,"[41, 15]":15,"[2, 15]":2,"[18, 8]":23,"[24, 7]":27,"[27, 0]":3,"[22, 11]":23,"[26, 6]":28,"[42, 2]":6,"[35, 10]":12,"[18, 17]":26,"[41, 8]":16,"[25, 17]":21,"[38, 10]":14,"[38, 11]":14,"[3, 15]":2,"[37, 11]":14,"[24, 19]":21,"[17, 17]":26,"[7, 5]":10,"[43, 1]":6,"[39, 16]":15,"[26, 4]":28,"[30, 16]":11,"[13, 14]":5,"[25, 3]":8,"[43, 0]":17,"[22, 4]":8,"[26, 1]":3,"[42, 14]":15,"[17, 9]":23,"[48, 0]":6,"[36, 14]":18,"[9, 19]":5,"[17, 10]":23,"[29, 19]":11,"[37, 13]":18,"[0, 19]":25,"[9, 16]":5,"[45, 1]":6,"[8, 4]":10,"[26, 3]":3,"[38, 8]":16,"[36, 11]":14,"[34, 18]":13,"[37, 4]":22,"[29, 6]":27,"[47, 4]":6,"[25, 14]":21,"[34, 16]":18,"[13, 2]":4,"[39, 11]":14,"[32, 18]":11,"[14, 13]":5,"[22, 5]":23,"[26, 18]":21,"[20, 16]":1,"[44, 0]":6,"[29, 17]":11,"[6, 19]":25,"[13, 17]":5,"[7, 7]":10,"[10, 3]":10,"[40, 15]":15,"[27, 14]":21,"[10, 15]":5,"[25, 9]":27,"[33, 11]":12,"[5, 19]":25,"[42, 7]":16,"[11, 14]":5,"[19, 12]":23,"[16, 10]":23,"[6, 7]":10,"[21, 18]":1,"[38, 4]":22,"[28, 14]":21,"[35, 5]":22,"[34, 2]":24,"[37, 5]":22,"[44, 6]":6,"[25, 4]":3,"[32, 14]":11,"[8, 8]":10,"[18, 12]":23,"[7, 14]":25,"[30, 11]":12,"[36, 8]":12,"[38, 7]":16,"[46, 5]":6,"[33, 15]":18,"[20, 19]":1,"[19, 7]":23,"[46, 0]":6,"[29, 11]":12,"[11, 18]":5,"[12, 13]":5,"[42, 8]":14,"[37, 10]":14,"[24, 3]":8,"[33, 3]":7,"[35, 13]":18,"[30, 10]":12,"[30, 15]":11,"[37, 12]":14,"[33, 19]":13,"[9, 18]":5,"[14, 15]":5,"[26, 19]":21,"[10, 14]":5,"[28, 13]":21,"[16, 9]":23,"[31, 1]":3,"[10, 19]":5,"[16, 8]":23,"[20, 6]":23,"[32, 0]":3,"[49, 0]":6,"[7, 8]":10,"[37, 19]":13,"[10, 2]":10,"[34, 6]":22,"[26, 0]":3,"[47, 0]":6,"[7, 19]":25,"[36, 19]":13,"[27, 18]":21,"[8, 17]":5,"[39, 6]":16,"[37, 14]":18,"[7, 10]":9,"[42, 5]":16,"[34, 14]":18,"[37, 15]":18,"[33, 2]":7,"[26, 13]":21,"[42, 3]":6,"[38, 3]":22,"[29, 14]":21,"[37, 9]":16,"[25, 0]":3,"[32, 1]":3,"[24, 13]":21,"[16, 18]":26,"[3, 14]":2,"[38, 0]":22,"[30, 12]":12,"[20, 12]":23,"[43, 6]":16,"[33, 1]":3,"[27, 8]":27,"[17, 8]":23,"[29, 15]":21,"[28, 7]":27,"[39, 3]":22,"[38, 13]":18,"[36, 9]":12,"[33, 16]":18,"[34, 1]":3,"[4, 13]":2,"[26, 17]":21,"[27, 19]":21,"[28, 12]":21,"[11, 19]":5,"[33, 5]":22,"[30, 6]":7,"[19, 13]":23,"[8, 15]":25,"[24, 5]":29,"[14, 17]":5,"[24, 10]":27,"[8, 19]":5,"[38, 14]":18,"[9, 14]":5,"[32, 19]":13,"[12, 18]":5,"[40, 5]":16,"[14, 14]":5,"[36, 17]":13,"[36, 5]":22,"[19, 6]":23,"[30, 14]":21,"[8, 3]":10,"[28, 18]":11,"[33, 0]":3,"[9, 3]":10,"[45, 6]":6,"[23, 4]":8,"[41, 5]":16,"[41, 14]":15,"[40, 11]":14,"[20, 13]":23,"[29, 13]":21,"[16, 11]":23,"[15, 11]":23,"[8, 16]":25,"[32, 17]":11,"[40, 14]":15,"[30, 13]":21,"[35, 17]":13,"[21, 12]":23,"[35, 6]":22,"[4, 14]":2,"[18, 7]":23,"[28, 19]":11,"[6, 10]":30,"[3, 13]":2,"[22, 14]":21,"[33, 14]":18,"[23, 10]":23,"[32, 8]":12,"[8, 18]":5,"[29, 12]":12,"[26, 12]":21,"[29, 16]":11,"[10, 4]":10,"[33, 17]":18,"[7, 13]":25,"[11, 13]":5,"[22, 12]":23,"[29, 10]":12,"[4, 15]":25,"[31, 8]":12,"[13, 13]":5,"[5, 12]":20,"[11, 2]":10,"[23, 13]":21,"[43, 7]":14,"[21, 13]":23,"[37, 8]":12,"[18, 6]":23,"[28, 11]":12,"[20, 5]":23,"[39, 13]":18,"[13, 12]":5,"[9, 2]":10,"[14, 12]":23,"[42, 4]":16,"[29, 7]":27,"[17, 7]":23,"[36, 6]":22,"[18, 5]":23,"[23, 14]":21,"[25, 10]":27,"[36, 16]":18,"[14, 11]":5,"[15, 10]":23,"[34, 17]":13,"[4, 12]":2,"[20, 15]":21,"[33, 18]":13,"[17, 6]":23,"[38, 16]":13,"[30, 9]":12,"[40, 3]":19,"[27, 17]":21,"[15, 19]":26,"[24, 12]":21,"[31, 19]":11,"[13, 0]":4,"[38, 18]":13,"[7, 11]":9,"[5, 11]":20,"[16, 12]":23,"[39, 14]":18,"[12, 12]":5,"[46, 6]":6,"[36, 10]":12,"[19, 4]":23,"[35, 12]":18,"[41, 4]":16,"[37, 7]":12,"[34, 11]":12,"[31, 9]":12,"[35, 7]":22,"[23, 12]":21,"[34, 13]":18,"[30, 19]":11,"[34, 7]":22,"[40, 4]":16,"[41, 13]":15,"[39, 15]":15,"[44, 1]":6,"[29, 9]":12,"[5, 14]":2,"[32, 5]":7,"[35, 16]":13,"[42, 10]":14,"[10, 6]":10,"[31, 14]":11,"[24, 1]":3,"[33, 7]":22,"[37, 16]":18,"[9, 7]":10,"[9, 8]":10,"[28, 17]":11,"[24, 0]":3,"[38, 12]":14,"[42, 13]":15,"[19, 16]":1,"[22, 3]":8,"[4, 11]":20,"[6, 14]":25,"[38, 5]":22,"[9, 15]":25,"[21, 5]":23,"[5, 13]":2,"[39, 4]":16,"[33, 8]":12,"[25, 12]":21,"[40, 13]":18,"[36, 12]":18,"[15, 12]":23,"[41, 3]":16,"[10, 8]":10,"[27, 12]":21,"[27, 11]":21,"[15, 18]":26,"[43, 3]":16,"[35, 11]":12,"[28, 16]":11,"[19, 14]":23,"[11, 3]":10,"[10, 7]":10,"[13, 18]":5,"[32, 12]":12,"[21, 14]":21,"[6, 15]":25,"[28, 8]":27,"[42, 12]":15,"[34, 12]":18,"[16, 7]":23,"[33, 6]":22,"[14, 10]":23,"[12, 2]":10,"[40, 12]":18,"[22, 13]":21,"[32, 13]":12,"[10, 5]":10,"[14, 0]":4,"[38, 6]":16,"[28, 9]":12,"[26, 10]":27,"[33, 13]":18,"[28, 15]":21,"[45, 0]":6,"[10, 13]":5,"[31, 6]":7,"[43, 8]":14,"[33, 12]":12,"[21, 4]":8,"[19, 5]":23,"[28, 10]":21,"[11, 4]":10,"[18, 4]":23,"[40, 10]":14},"graph_hash":{"1":[26,21],"2":[25,20],"3":[7,28,8,27,29,24],"4":[10],"5":[25,23],"6":[16,19,17,14],"7":[3,27,22,24],"8":[3,29,23],"9":[30,10,20],"10":[30,9,4],"11":[18,13,12,21],"12":[22,21,16,14,18,11,27],"13":[18,15,11],"14":[16,18,12,6],"15":[13,18],"16":[14,6,12,19,22],"17":[19,6],"18":[13,14,11,15,12],"19":[17,22,6,16],"20":[9,30,2],"21":[1,12,11,23],"22":[24,19,7,16,12],"23":[29,27,8,5,21],"24":[3,22,7],"25":[2,5],"26":[1],"27":[28,3,23,29,7,12],"28":[27,29,3],"29":[23,8,3,28,27],"30":[9,10,20]}};

var hexes = sample_data["hexes"];
var hex_re = /\[(\d+), (\d+)\]/;

var region_hash = {};


var game_board = document.getElementById("game-display");
var board_context = game_board.getContext("2d"); 

var scale_x =800;
var scale_y =400;
var height = sample_data["height"];
var width = sample_data["width"];
var unit = scale_x/width/2;
var cos_30 = Math.cos(30/360*Math.PI*2);

var draw_region = function (region, reg_hexes){
	board_context.lineWidth = 1;
	board_context.fillStyle = "#8ED6FF";
	board_context.beginPath();
	for(item in reg_hexes){
		draw_hex(reg_hexes[item][0],reg_hexes[item][1],region);
	}	
	//board_context.closePath();
	board_context.fill();
	board_context.stroke();	

};

var draw_hex = function(q,r,reg){	
	
	bc = board_context;	
	by = unit+unit*r*(1.5);
	bx = r*unit*cos_30+(q-(height/2-1))*unit*cos_30*2;		
	points = {
		ne : [Math.round(bx+cos_30*unit), Math.round(by-.5*unit)],
		n  : [Math.round(bx), Math.round(by-unit)],
		nw : [Math.round(bx-cos_30*unit), Math.round(by-.5*unit)],
		sw : [Math.round(bx-cos_30*unit), Math.round(by+.5*unit)],
		s  : [Math.round(bx), Math.round(by+unit)],
		se : [Math.round(bx+cos_30*unit), Math.round(by+.5*unit)]
		};
	edges = {
		e : [points.ne, points.se],
		ne: [points.ne, points.n],
		nw: [points.n, points.nw],
		w : [points.nw, points.sw],
		sw: [points.sw, points.s],
		se: [points.s, points.se]
	};

	if(!e_neighbor_match(q,r,reg)){
		bc.moveTo(edges.e[0][0],edges.e[0][1]);
		bc.lineTo(edges.e[1][0],edges.e[1][1]);
	}

	if(!ne_neighbor_match(q,r,reg)){
		bc.moveTo(edges.ne[0][0],edges.ne[0][1]);
		bc.lineTo(edges.ne[1][0],edges.ne[1][1]);	
	}

	if(!nw_neighbor_match(q,r,reg)){
		bc.moveTo(edges.nw[0][0],edges.nw[0][1]);
		bc.lineTo(edges.nw[1][0],edges.nw[1][1]);	
	}

	if(!w_neighbor_match(q,r,reg)){
		bc.moveTo(edges.w[0][0],edges.w[0][1]);
		bc.lineTo(edges.w[1][0],edges.w[1][1]);	
	}

	if(!sw_neighbor_match(q,r,reg)){
		bc.moveTo(edges.sw[0][0],edges.sw[0][1]);
		bc.lineTo(edges.sw[1][0],edges.sw[1][1]);	
	}

	if(!se_neighbor_match(q,r,reg)){
		bc.moveTo(edges.se[0][0],edges.se[0][1]);
		bc.lineTo(edges.se[1][0],edges.se[1][1]);	
	}	
	
};

var ne_neighbor_match = function(q,r,reg){
	return neighbor_match(q+1,r-1,reg);
};

var sw_neighbor_match = function(q,r,reg){	
	return neighbor_match(q-1,r+1,reg);
};

var e_neighbor_match = function(q,r,reg){
	return neighbor_match(q+1,r,reg);
};

var se_neighbor_match = function(q,r,reg){	
	return neighbor_match(q,r+1,reg);
};

var w_neighbor_match = function(q,r,reg){
	return neighbor_match(q-1,r,reg);
};

var nw_neighbor_match = function(q,r,reg){	
	return neighbor_match(q,r-1,reg);
};

var neighbor_match = function(q, r, reg){
	return parseInt(reg) === hexes["["+q+", "+r+"]"];
}

for (var value in hexes){
	var vals = value.match(hex_re);
	var reg = hexes[value];
	if(!region_hash[reg]){
		region_hash[reg] = [];
	}
	region_hash[reg].push([parseInt(vals[1]), parseInt(vals[2])]);	 	
}

//for(var region in region_hash){
//	draw_region(region, region_hash[region]);
//}

draw_region(1, region_hash[1]);

//board_context.stroke();
//draw_hex(10,0);